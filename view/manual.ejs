<!DOCTYPE html><html>

<head>
    <meta charset="utf-8">
    <title>ManualProject</title>
    <style type="text/css">
        body {
            font-family: Helvetica, arial, sans-serif;
            font-size: 14px;
            line-height: 1.6;
            padding-top: 10px;
            padding-bottom: 10px;
            background-color: white;
            padding: 30px; }

        body > *:first-child {
            margin-top: 0 !important; }
        body > *:last-child {
            margin-bottom: 0 !important; }

        a {
            color: #4183C4; }
        a.absent {
            color: #cc0000; }
        a.anchor {
            display: block;
            padding-left: 30px;
            margin-left: -30px;
            cursor: pointer;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0; }

        h1, h2, h3, h4, h5, h6 {
            margin: 20px 0 10px;
            padding: 0;
            font-weight: bold;
            -webkit-font-smoothing: antialiased;
            cursor: text;
            position: relative; }

        h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
            background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
            text-decoration: none; }

        h1 tt, h1 code {
            font-size: inherit; }

        h2 tt, h2 code {
            font-size: inherit; }

        h3 tt, h3 code {
            font-size: inherit; }

        h4 tt, h4 code {
            font-size: inherit; }

        h5 tt, h5 code {
            font-size: inherit; }

        h6 tt, h6 code {
            font-size: inherit; }

        h1 {
            font-size: 28px;
            color: black; }

        h2 {
            font-size: 24px;
            border-bottom: 1px solid #cccccc;
            color: black; }

        h3 {
            font-size: 18px; }

        h4 {
            font-size: 16px; }

        h5 {
            font-size: 14px; }

        h6 {
            color: #777777;
            font-size: 14px; }

        p, blockquote, ul, ol, dl, li, table, pre {
            margin: 15px 0; }

        hr {
            background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
            border: 0 none;
            color: #cccccc;
            height: 4px;
            padding: 0;
        }

        body > h2:first-child {
            margin-top: 0;
            padding-top: 0; }
        body > h1:first-child {
            margin-top: 0;
            padding-top: 0; }
        body > h1:first-child + h2 {
            margin-top: 0;
            padding-top: 0; }
        body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
            margin-top: 0;
            padding-top: 0; }

        a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
            margin-top: 0;
            padding-top: 0; }

        h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
            margin-top: 0; }

        li p.first {
            display: inline-block; }
        li {
            margin: 0; }
        ul, ol {
            padding-left: 30px; }

        ul :first-child, ol :first-child {
            margin-top: 0; }

        dl {
            padding: 0; }
        dl dt {
            font-size: 14px;
            font-weight: bold;
            font-style: italic;
            padding: 0;
            margin: 15px 0 5px; }
        dl dt:first-child {
            padding: 0; }
        dl dt > :first-child {
            margin-top: 0; }
        dl dt > :last-child {
            margin-bottom: 0; }
        dl dd {
            margin: 0 0 15px;
            padding: 0 15px; }
        dl dd > :first-child {
            margin-top: 0; }
        dl dd > :last-child {
            margin-bottom: 0; }

        blockquote {
            border-left: 4px solid #dddddd;
            padding: 0 15px;
            color: #777777; }
        blockquote > :first-child {
            margin-top: 0; }
        blockquote > :last-child {
            margin-bottom: 0; }

        table {
            padding: 0;border-collapse: collapse; }
        table tr {
            border-top: 1px solid #cccccc;
            background-color: white;
            margin: 0;
            padding: 0; }
        table tr:nth-child(2n) {
            background-color: #f8f8f8; }
        table tr th {
            font-weight: bold;
            border: 1px solid #cccccc;
            margin: 0;
            padding: 6px 13px; }
        table tr td {
            border: 1px solid #cccccc;
            margin: 0;
            padding: 6px 13px; }
        table tr th :first-child, table tr td :first-child {
            margin-top: 0; }
        table tr th :last-child, table tr td :last-child {
            margin-bottom: 0; }

        img {
            max-width: 100%; }

        span.frame {
            display: block;
            overflow: hidden; }
        span.frame > span {
            border: 1px solid #dddddd;
            display: block;
            float: left;
            overflow: hidden;
            margin: 13px 0 0;
            padding: 7px;
            width: auto; }
        span.frame span img {
            display: block;
            float: left; }
        span.frame span span {
            clear: both;
            color: #333333;
            display: block;
            padding: 5px 0 0; }
        span.align-center {
            display: block;
            overflow: hidden;
            clear: both; }
        span.align-center > span {
            display: block;
            overflow: hidden;
            margin: 13px auto 0;
            text-align: center; }
        span.align-center span img {
            margin: 0 auto;
            text-align: center; }
        span.align-right {
            display: block;
            overflow: hidden;
            clear: both; }
        span.align-right > span {
            display: block;
            overflow: hidden;
            margin: 13px 0 0;
            text-align: right; }
        span.align-right span img {
            margin: 0;
            text-align: right; }
        span.float-left {
            display: block;
            margin-right: 13px;
            overflow: hidden;
            float: left; }
        span.float-left span {
            margin: 13px 0 0; }
        span.float-right {
            display: block;
            margin-left: 13px;
            overflow: hidden;
            float: right; }
        span.float-right > span {
            display: block;
            overflow: hidden;
            margin: 13px auto 0;
            text-align: right; }

        code, tt {
            margin: 0 2px;
            padding: 0 5px;
            white-space: nowrap;
            border: 1px solid #eaeaea;
            background-color: #f8f8f8;
            border-radius: 3px; }

        pre code {
            margin: 0;
            padding: 0;
            white-space: pre;
            border: none;
            background: transparent; }

        .highlight pre {
            background-color: #f8f8f8;
            border: 1px solid #cccccc;
            font-size: 13px;
            line-height: 19px;
            overflow: auto;
            padding: 6px 10px;
            border-radius: 3px; }

        pre {
            background-color: #f8f8f8;
            border: 1px solid #cccccc;
            font-size: 13px;
            line-height: 19px;
            overflow: auto;
            padding: 6px 10px;
            border-radius: 3px; }
        pre code, pre tt {
            background-color: transparent;
            border: none; }

        sup {
            font-size: 0.83em;
            vertical-align: super;
            line-height: 0;
        }
        * {
            -webkit-print-color-adjust: exact;
        }
        @media screen and (min-width: 914px) {
            body {
                width: 854px;
                margin:0 auto;
            }
        }
        @media print {
            table, pre {
                page-break-inside: avoid;
            }
            pre {
                word-wrap: break-word;
            }
        }
    </style>
    <style type="text/css">
        /**
         * prism.js default theme for JavaScript, CSS and HTML
         * Based on dabblet (http://dabblet.com)
         * @author Lea Verou
         */

        code[class*="language-"],
        pre[class*="language-"] {
            color: black;
            text-shadow: 0 1px white;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            direction: ltr;
            text-align: left;
            white-space: pre;
            word-spacing: normal;
            word-break: normal;
            line-height: 1.5;

            -moz-tab-size: 4;
            -o-tab-size: 4;
            tab-size: 4;

            -webkit-hyphens: none;
            -moz-hyphens: none;
            -ms-hyphens: none;
            hyphens: none;
        }

        pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
        code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
            text-shadow: none;
            background: #b3d4fc;
        }

        pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
        code[class*="language-"]::selection, code[class*="language-"] ::selection {
            text-shadow: none;
            background: #b3d4fc;
        }

        @media print {
            code[class*="language-"],
            pre[class*="language-"] {
                text-shadow: none;
            }
        }

        /* Code blocks */
        pre[class*="language-"] {
            padding: 1em;
            margin: .5em 0;
            overflow: auto;
        }

        :not(pre) > code[class*="language-"],
        pre[class*="language-"] {
            background: #f5f2f0;
        }

        /* Inline code */
        :not(pre) > code[class*="language-"] {
            padding: .1em;
            border-radius: .3em;
        }

        .token.comment,
        .token.prolog,
        .token.doctype,
        .token.cdata {
            color: slategray;
        }

        .token.punctuation {
            color: #999;
        }

        .namespace {
            opacity: .7;
        }

        .token.property,
        .token.tag,
        .token.boolean,
        .token.number,
        .token.constant,
        .token.symbol,
        .token.deleted {
            color: #905;
        }

        .token.selector,
        .token.attr-name,
        .token.string,
        .token.char,
        .token.builtin,
        .token.inserted {
            color: #690;
        }

        .token.operator,
        .token.entity,
        .token.url,
        .language-css .token.string,
        .style .token.string {
            color: #a67f59;
            background: hsla(0, 0%, 100%, .5);
        }

        .token.atrule,
        .token.attr-value,
        .token.keyword {
            color: #07a;
        }

        .token.function {
            color: #DD4A68;
        }

        .token.regex,
        .token.important,
        .token.variable {
            color: #e90;
        }

        .token.important,
        .token.bold {
            font-weight: bold;
        }
        .token.italic {
            font-style: italic;
        }

        .token.entity {
            cursor: help;
        }
    </style>
    <style type="text/css">
        pre.line-numbers {
            position: relative;
            padding-left: 3.8em;
            counter-reset: linenumber;
        }

        pre.line-numbers > code {
            position: relative;
        }

        .line-numbers .line-numbers-rows {
            position: absolute;
            pointer-events: none;
            top: 0;
            font-size: 100%;
            left: -3.8em;
            width: 3em; /* works for line-numbers below 1000 lines */
            letter-spacing: -1px;
            border-right: 1px solid #999;

            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;

        }

        .line-numbers-rows > span {
            pointer-events: none;
            display: block;
            counter-increment: linenumber;
        }

        .line-numbers-rows > span:before {
            content: counter(linenumber);
            color: #999;
            display: block;
            padding-right: 0.8em;
            text-align: right;
        }
    </style>
</head>
<body>
<h1 id="toc_0">PCEO Manual</h1>

<h4 id="toc_1">Floating people counter with Bluetooth Beacon.</h4>

<h2 id="toc_2">필요한 부품</h2>

<ul>
    <li>아두이노 <strong>우노</strong> (레오나르도 안됨)</li>
    <li><a href="http://storefarm.naver.com/domekit/products/317092771">HM-10</a> (블루투스 4.0, BLE / iBeacon 지원, 핀 나온 거)</li>
    <li>CR2032 배터리 및 케이스</li>
    <li>암/수 범퍼 케이블. </li>
    <li><a href="http://item2.gmarket.co.kr/Item/detailview/Item.aspx?goodscode=731221604">아두이노 연결 케이블</a></li>
    <li>Bluetooth 4.0을 지원하는 안드로이드 디바이스</li>
    <li>Android L 이상이 설치되어있는 안드로이드 디바이스</li>
    <li><del>개발자</del></li>
</ul>

<h2 id="toc_3">필요한 파트</h2>

<h3 id="toc_4">안드로이드</h3>

<ul>
    <li>안드로이드 스튜디오 깔고, 세팅하기. <a href="http://developer.android.com/intl/ko/sdk/index.html">다운로드</a></li>
    <li>Gradle Script - build.gradle(Module: app) - dependencies에 내용 추가</li>
</ul>

<pre class="line-numbers"><code class="language-gradle">compile &#39;com.googlecode.json-simple:json-simple:1.1&#39;
        compile &#39;com.squareup.okhttp3:okhttp:3.0.1&#39;
        compile &#39;org.altbeacon:android-beacon-library:2+&#39;</code></pre>

<ul>
    <li><a href="https://altbeacon.github.io/android-beacon-library/index.html">설명서</a> 보고 개발하기.</li>
    <li>주의사항 - <code>getInstanceForApplication</code>과 <code>bind</code>사이에 다음 내용을 적어 넣을 것.</li>
</ul>

<pre class="line-numbers"><code class="language-java">manager.getBeaconParsers().add(new BeaconParser().
        setBeaconLayout(&quot;m:2-3=0215,i:4-19,i:20-21,i:22-23,p:24-24&quot;));</code></pre>

<h5 id="toc_5">참고사항</h5>

<ul>
    <li>onBeaconServiceConnect 안 setRangeNotifier에선 검색된 비콘의 리스트를 <strong>Collection</strong>으로 반환한다.</li>
    <li>이를 정렬된 <strong>ArrayList</strong>로 만들어 두는 것이 개발에 편리할 것이다.</li>
    <li>현재 가장 가까운 위치에 있는 것으로 하려면 ArrayList를 Distance를 기준으로 정렬하는게 편하다.</li>
</ul>

<pre class="line-numbers"><code class="language-java">public class BeaconComparator implements Comparator&lt;Beacon&gt; {
        @Override
        public int compare(Beacon lhs, Beacon rhs) {
        return Double.compare(lhs.getDistance(), rhs.getDistance());
        }
        }</code></pre>

<p>다음과 같은 클래스를 생성하고, setRangeNotifier 안에 다음과 같은 코드를 작성하면 정렬된 상태로 작업 가능하다.</p>

<pre class="line-numbers"><code class="language-java">ArrayList&lt;Beacon&gt; list = new ArrayList&lt;Beacon&gt;(collection);
        Collections.sort(list, new BeaconComparator());</code></pre>

<ul>
    <li>UUID 이용해서 구분하는 것이 편하다. 비콘 UUID 바꾸는 법은 블루투스 비콘 세팅 방법에서 나올 예정이다.</li>
    <li>UUID를 문자열로 가져오는 법은 다음과 같다.</li>
</ul>

<pre class="line-numbers"><code class="language-java">beacon.getId1().toUuid().toString()</code></pre>

<h3 id="toc_6">서버</h3>

<p>(깃허브 주소)<br>
    제대로 구성되어 있지 않은 서버임을 가정하고 쓰겠음. 일단 잘못 짜기는 했지만..</p>

<p><strong>Ubuntu 서버라 가정하였습니다. 이용 시에는 서버가 필요합니다.</strong><br>
    만약 오류가 난다면, 높은 확률로 퍼미션 오류이니, 명령어 맨 앞에 <code>sudo</code>를 입력하면 된다.<br>
    <code>sudo</code>가 꼭 필요하면 앞에 적어드립니다.</p>

<ol>
    <li><code>git clone https://github.com/tj/n</code>을 입력하여 해당 Repository를 clone.</li>
    <li><code>cd n</code>으로 이동, <code>make install</code>로 설치한다.</li>
    <li><code>n 5.5.0</code>을 입력한다.</li>
    <li><code>sudo apt-get install mongodb</code>를 입력한다.</li>
    <li><code>lsb_release -a</code>로 codename을 확인.</li>
    <li><code>curl -O http://nginx.org/keys/nginx_signing.key</code>를 입력한다.</li>
    <li><code>sudo apt-key add nginx_signing.key</code>를 입력한다.</li>
    <li><code>sudo vim /etc/apt/sources.list</code>를 입력하고, 마지막 줄에 다음과 같이 입력한다.</li>
</ol>

<pre class="line-numbers"><code class="language-none">deb http://nginx.org/packages/ubuntu/ codename nginx
        deb-src http://nginx.org/packages/ubuntu/ codename nginx</code></pre>

<p>여기서 Codename은 <strong>5번</strong>에서 확인한 이름을 입력해야 한다.</p>

<ol>
    <li><code>apt-get update</code>를 입력하고 기다린다.</li>
    <li><code>apt-get install nginx</code>를 입력한다. </li>
    <li><code>sudo service nginx start</code>를 입력한다.</li>
    <li>웹으로 서버 주소를 입력하고 될때까지 기다린다. 되면 <code>Welcome to Nginx</code>라는 문구가 뜬다. 기다린다. 좀 오래 걸리니 다른 작업을 먼저 하고 있길 추천함.</li>
    <li><code>cd /etc/nginx</code>라고 입력한다.</li>
    <li><code>sudo vim sites-enabled/default</code>이라고 입력하고, 다음과 같은 내용을 상위에 적어놓는다.</li>
</ol>

<pre class="line-numbers"><code class="language-none">upstream postech {
        server 127.0.0.1:7230;
        }</code></pre>

<p>그리고 다음과 같은 내용 줄의 맨 앞에 <strong>#</strong>을 써넣는다. <strong>#</strong>이 이미 붙어있으면 안해도 된다.</p>

<pre class="line-numbers"><code class="language-none">root /var/www/html;

        server_name _;

        location / {
        try_files $uri $uri/ =404;
        }</code></pre>

<p><strong>서버를 다운받아 실행시키는 법</strong></p>

<ol>
    <li><code>git clone 깃허브 주소</code>를 입력한다.</li>
    <li><code>cd 리포지토리 이름</code>을 입력한다.</li>
    <li><code>npm install</code>이라고 입력한다.</li>
    <li>정성을 다해 기다린다.</li>
    <li><code>pm2 start postech.json</code>이라고 입력한다.</li>
</ol>

<p><strong>데이터베이스에 장소 추가하는 법</strong></p>

<ol>
    <li><code>mongo</code>를 입력하여 몽고디비 콘솔로 들어간다.</li>
    <li><code>use population</code>을 입력한다.</li>
    <li>다음과 같은 형태로 입력한다.</li>
</ol>

<pre class="line-numbers"><code class="language-javascript">i = {
        name : &quot;장소 이름&quot;,
        uuid : &quot;비콘 UUID&quot;,
        location : {
        latitude : 위도,
        longitude : 경도
        }
        };  </code></pre>

<p><strong>예시</strong></p>

<pre class="line-numbers"><code class="language-javascript">i = {
        name : &quot;포항공대 무한상상실 5층 Creative Lab.&quot;,
        uuid : &quot;aaaaaaaa-b644-4520-8f0c-720eaf059935&quot;,
        location : {
        &quot;longitude&quot; : 129.317881,
        &quot;latitude&quot; : 36.023759
        }
        }</code></pre>

<p>그리고 넣어준다.<br>
    <code>db.locations.insert(i)</code></p>

<p><strong>장소 리스트 확인하기</strong></p>

<ol>
    <li><code>mongo</code>를 입력하여 몽고디비 콘솔로 들어간다.</li>
    <li><code>use population</code>을 입력한다.</li>
    <li><code>db.locations.find()</code>하면 검색된다. 양이 많을 경우 it을 치면 더 확인할 수 있다.</li>
</ol>

<p><strong>기록 삭제하기</strong></p>

<ol>
    <li><code>mongo</code>를 입력하여 몽고디비 콘솔로 들어간다.</li>
    <li><code>use population</code>을 입력한다.</li>
    <li><code>db.logs.remove({})</code> 를 입력하면 삭제된다.</li>
</ol>

<p><strong>로그 확인하기</strong></p>

<ol>
    <li><code>mongo</code>를 입력하여 몽고디비 콘솔로 들어간다.</li>
    <li><code>use population</code>을 입력한다.</li>
    <li><code>db.logs.find({})</code> 를 입력하면 검색된다. 양이 많을 경우 it을 치면 더 확인할 수 있다.</li>
</ol>

<h3 id="toc_7">블루투스 비콘</h3>

<p>아두이노를 이용하여 세팅한다. 아두이노 IDE는 <a href="https://www.arduino.cc/en/Main/Software">이 주소</a>에서 다운로드 가능하다.</p>

<div style="text-align:center;">
    <img id="img11" class="img11" src="http://dev.chansol.net/manual/img/ArBo.png" style="width:400px;" alt="Arduino Tools menu, Board Setting image">
    <span class="img11alt1" style="display:none;margin-bottom:10px;">[Image 1-1]</span>
    <img id="img12" class="img12" src="http://dev.chansol.net/manual/img/ArPo.png" style="width:380px;margin-left:30px;" alt="Arduino Tools menu, Port Setting image">
    <span class="img12alt1" style="display:none;">[Image 1-2]</span>
    <br>
</div>
<p>실행 전, <strong>Tools -&gt; Board</strong>에서 <strong>Arduino/Genuino Uno</strong>를, <strong>Tools -&gt; Port</strong>에서 연결된 포트를 선택한다.</p>

<p>소켓 점퍼 케이블은 다음과 같이 연결해준다.</p>

<table>
    <thead>
    <tr>
        <th style="text-align: center">BLE 모듈</th>
        <th style="text-align: center">아두이노</th>
    </tr>
    </thead>

    <tbody>
    <tr>
        <td style="text-align: center">VCC</td>
        <td style="text-align: center">5V</td>
    </tr>
    <tr>
        <td style="text-align: center">GND</td>
        <td style="text-align: center">GND</td>
    </tr>
    <tr>
        <td style="text-align: center">TXD</td>
        <td style="text-align: center">Digital 2번</td>
    </tr>
    <tr>
        <td style="text-align: center">RXD</td>
        <td style="text-align: center">Digital 3번</td>
    </tr>
    </tbody>
</table>

<p>BLE모둘과 통신하기 위해, 아두이노 IDE를 열고 다음과 같이 입력한다.</p>

<pre class="line-numbers"><code class="language-c">#include &lt;SoftwareSerial.h&gt;
        SoftwareSerial BTSerial(2, 3); // 시리얼 통신을 위한 송신(TX) 수신(RX)을 각각 D2(TX-&gt;디지털2), D3(RX-&gt;디지털3)로
        // 예제: SoftwareSerial BTSerial(TX, RX);

        void setup() {
        // put your setup code here, to run once:
        Serial.begin(9600); // 아두이노와 시리얼 통신 활성화 (속도는 9600)
        Serial.println(&quot;Ready!&quot;); // 확인용 (시리얼 모니터에 &#39;Ready!&#39; 출력)

        BTSerial.begin(9600); // HM-10모듈과 시리얼 통신
        }

        void loop() {
        // put your main code here, to run repeatedly:
        while (BTSerial.available()){ // HM-10모듈이 뭔가 정보를 보내오면
        byte data = BTSerial.read(); // 읽은 데이터를 data 변수에 저장해서
        Serial.write(data); // data 변수의 값을 시리얼 모니터에 출력
        }

        while (Serial.available()){ // 만약 (시리얼 모니터를 통해) 입력이 발생하면
        byte data = Serial.read(); // data 변수에 저장하고
        BTSerial.write(data); // data 변수의 데이터를 HM-10모듈에 기록
        }
        }</code></pre>

<p><strong>제대로</strong> 연결되었다면, 시리얼 모니터를 켰을 때 다음과 같은 화면이 뜬다.</p>

<p><img src="http://dev.chansol.net/manual/img/ArSeAT.png" alt=""></p>

<p>BLE모듈을 iBeacon으로 구성하기 위해서 시리얼 모니터에 다음과 같은 명령어를 입력한다. 만약, 비콘으로 구성된 이후 <strong>HM-10의 LED가 꺼진 잠자기 모드로 진입한 경우</strong> AT 명령어를 입력하기 위해 깨우려면 아무 텍스트나 80자 이상 보내면 AT+WAKE를 시리얼 모니터에 출력하면서 깨어난다.</p>

<ol>
    <li>AT+RENEW //공장 초기화 값으로 롤백</li>
    <li>AT+RESET //HM-10 재시작</li>
    <li>AT //동작 확인용, 시리얼 모니터에 OK라고 출력되는지 확인한다.</li>
    <li>AT+MARJ0x1235 //비콘의 Major number를 설정한다. 0x1235와 같은 hex 값으로 입력한다.</li>
    <li>AT+MINO0x5321 //비콘의 Minor number필수는 아니며, 0x1235와 같은 hex 값으로 입력한다.</li>
    <li>AT+ADVI1 //신호 송출 주기를 설정한다. 명령어의 1 부분은 1 milliseconds를 의미한다.</li>
    <li>AT+NAMEPCEO //블루투스 장치의 이름을 PCEO로 설정한다.</li>
    <li>AT+ADTY3 //Non-connectable 모드를 설정한다. (절전)</li>
    <li>AT+IBEA1 //iBeacon 규격으로 비콘 모드를 활성화한다.</li>
    <li>AT+DELO2 //Broadcast-only 모드를 설정한다. (절전)</li>
    <li>AT+PWRM0 //Auto-sleep 모드를 활성화한다. 약 8mA에서 약 0.18mA로 전원을 절약하는 효과가 있다.</li>
    <li>AT+RESET //HM-10을 재시작하여 설정 반영</li>
</ol>

<p>원하는 것만 설정해서 사용하면 된다.제대로 되었다면 이렇게 나온다.</p>

<p><img src="http://dev.chansol.net/manual/img/ArSeATiBeacon.png" alt=""></p>

<p>마지막으로, 휴대폰에서 비콘을 구분하기 위해선 UUID(Universally Unique IDentifier)을 사용한다. 기본 세팅은 동일하게 되어있는데, 직접 바꾸어 주어야지만 안드로이드하고 서버단에서 구분이 가능하다.</p>

<p>기본 UUID는 <strong>74278BDA-B644-4520-8F0C-720EAF059935</strong>이고, <br>
    <strong>74278BDA</strong> | <strong>B644-4520</strong> | <strong>8F0C-720E</strong> | <strong>AF059935</strong> 8글자씩 나누어 세팅 가능하다.</p>

<p>16 byte로 구성된 UUID값은 4 byte로 끊어서 각기 다른 명령어를 통해 임의로 변경할 수 있는데, 이때 사용되는 명령어는 AT+IBE0 ~ AT+IBE3이다. 아래에서는 각기 명령어로 변경되는 UUID 부분을 색상별로 구분해 두었다.
</p>

<table summary="BLE모듈(HM-10)을 통해 iBeacon 구성 시 기본 할당되는 UUID 값과 그 값을 변경할 때 사용되는 명령어가 UUID의 어느 부분에 변경사항이 반영되는지 표로 정리해두었다." class="uuidCommandTable" border="1" style="text-align:center;border:1px solid black;border-collapse:collapse;width:100%;">
    <caption style="overflow:hidden;visibility:hidden;width:0px;height:0px;font-size:0;">iBeacon의 UUID 변경 명령어와 매칭되는 부분 구분표</caption>
    <tbody><tr>
        <td colspan="4"><span style="color:red;">74278BDA</span>-<span style="color:green;">B644</span>-<span style="color:green;">4520</span>-<span style="color:blue;">8F0C</span>-<span style="color:blue;">720E</span><span style="color:purple;">AF059935</span></td>
    </tr>
    <tr>
        <td><span style="color:red;">AT+IBE074278BDA</span></td>
        <td><span style="color:green;">AT+IBE1B6444520</span></td>
        <td><span style="color:blue;">AT+IBE28F0C720E</span></td>
        <td><span style="color:purple;">AT+IBE3AF059935</span></td>
    </tr>
    </tbody></table>

<p>뭔가 문제가 있거나 잘 안되면 <b>오익이를 부르면 된다.</b></p>

<script type="text/javascript">
    var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=_self.Prism={util:{encode:function(e){return e instanceof n?new n(e.type,t.util.encode(e.content),e.alias):"Array"===t.util.type(e)?e.map(t.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){var n=t.util.type(e);switch(n){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=t.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return t.util.clone(e)})}return e}},languages:{extend:function(e,n){var a=t.util.clone(t.languages[e]);for(var r in n)a[r]=n[r];return a},insertBefore:function(e,n,a,r){r=r||t.languages;var i=r[e];if(2==arguments.length){a=arguments[1];for(var l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);return i}var s={};for(var o in i)if(i.hasOwnProperty(o)){if(o==n)for(var l in a)a.hasOwnProperty(l)&&(s[l]=a[l]);s[o]=i[o]}return t.languages.DFS(t.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=s)}),r[e]=s},DFS:function(e,n,a){for(var r in e)e.hasOwnProperty(r)&&(n.call(e,r,e[r],a||r),"Object"===t.util.type(e[r])?t.languages.DFS(e[r],n):"Array"===t.util.type(e[r])&&t.languages.DFS(e[r],n,r))}},highlightAll:function(e,n){for(var a,r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'),i=0;a=r[i++];)t.highlightElement(a,e===!0,n)},highlightElement:function(a,r,i){for(var l,s,o=a;o&&!e.test(o.className);)o=o.parentNode;if(o&&(l=(o.className.match(e)||[,""])[1],s=t.languages[l]),a.className=a.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,o=a.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l),s){var u=a.textContent;if(u){u=u.replace(/^(?:\r?\n|\r)/,"");var g={element:a,language:l,grammar:s,code:u};if(t.hooks.run("before-highlight",g),r&&_self.Worker){var c=new Worker(t.filename);c.onmessage=function(e){g.highlightedCode=n.stringify(JSON.parse(e.data),l),t.hooks.run("before-insert",g),g.element.innerHTML=g.highlightedCode,i&&i.call(g.element),t.hooks.run("after-highlight",g)},c.postMessage(JSON.stringify({language:g.language,code:g.code}))}else g.highlightedCode=t.highlight(g.code,g.grammar,g.language),t.hooks.run("before-insert",g),g.element.innerHTML=g.highlightedCode,i&&i.call(a),t.hooks.run("after-highlight",g)}}},highlight:function(e,a,r){var i=t.tokenize(e,a);return n.stringify(t.util.encode(i),r)},tokenize:function(e,n){var a=t.Token,r=[e],i=n.rest;if(i){for(var l in i)n[l]=i[l];delete n.rest}e:for(var l in n)if(n.hasOwnProperty(l)&&n[l]){var s=n[l];s="Array"===t.util.type(s)?s:[s];for(var o=0;o<s.length;++o){var u=s[o],g=u.inside,c=!!u.lookbehind,f=0,h=u.alias;u=u.pattern||u;for(var p=0;p<r.length;p++){var d=r[p];if(r.length>e.length)break e;if(!(d instanceof a)){u.lastIndex=0;var m=u.exec(d);if(m){c&&(f=m[1].length);var y=m.index-1+f,m=m[0].slice(f),v=m.length,k=y+v,b=d.slice(0,y+1),w=d.slice(k+1),N=[p,1];b&&N.push(b);var O=new a(l,g?t.tokenize(m,g):m,h);N.push(O),w&&N.push(w),Array.prototype.splice.apply(r,N)}}}}}return r},hooks:{all:{},add:function(e,n){var a=t.hooks.all;a[e]=a[e]||[],a[e].push(n)},run:function(e,n){var a=t.hooks.all[e];if(a&&a.length)for(var r,i=0;r=a[i++];)r(n)}}},n=t.Token=function(e,t,n){this.type=e,this.content=t,this.alias=n};if(n.stringify=function(e,a,r){if("string"==typeof e)return e;if("Array"===t.util.type(e))return e.map(function(t){return n.stringify(t,a,e)}).join("");var i={type:e.type,content:n.stringify(e.content,a,r),tag:"span",classes:["token",e.type],attributes:{},language:a,parent:r};if("comment"==i.type&&(i.attributes.spellcheck="true"),e.alias){var l="Array"===t.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(i.classes,l)}t.hooks.run("wrap",i);var s="";for(var o in i.attributes)s+=o+'="'+(i.attributes[o]||"")+'"';return"<"+i.tag+' class="'+i.classes.join(" ")+'" '+s+">"+i.content+"</"+i.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var n=JSON.parse(e.data),a=n.language,r=n.code;_self.postMessage(JSON.stringify(t.util.encode(t.tokenize(r,t.languages[a])))),_self.close()},!1),_self.Prism):_self.Prism;var a=document.getElementsByTagName("script");return a=a[a.length-1],a&&(t.filename=a.src,document.addEventListener&&!a.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism);
</script>
<script type="text/javascript">
    Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:/("|')(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,"class-name":{pattern:/((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/,operator:/[-+]{1,2}|!|<=?|>=?|={1,3}|&{1,2}|\|?\||\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/};
</script>
<script type="text/javascript">
    Prism.languages.c=Prism.languages.extend("clike",{keyword:/\b(asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/,operator:/\-[>-]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|?\||[~^%?*\/]/}),Prism.languages.insertBefore("c","string",{macro:{pattern:/(^\s*)#\s*[a-z]+([^\r\n\\]|\\.|\\(?:\r\n?|\n))*/im,lookbehind:!0,alias:"property",inside:{string:{pattern:/(#\s*include\s*)(<.+?>|("|')(\\?.)+?\3)/,lookbehind:!0}}}}),delete Prism.languages.c["class-name"],delete Prism.languages.c["boolean"];
</script>
<script type="text/javascript">
    Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|false|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|true|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,"function":/(?!\d)[a-z0-9_$]+(?=\()/i}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0}}),Prism.languages.insertBefore("javascript","class-name",{"template-string":{pattern:/`(?:\\`|\\?[^`])*`/,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/<script[\w\W]*?>[\w\W]*?<\/script>/i,inside:{tag:{pattern:/<script[\w\W]*?>|<\/script>/i,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript},alias:"language-javascript"}});
</script>
<script type="text/javascript">
    Prism.languages.java=Prism.languages.extend("clike",{keyword:/\b(abstract|continue|for|new|switch|assert|default|goto|package|synchronized|boolean|do|if|private|this|break|double|implements|protected|throw|byte|else|import|public|throws|case|enum|instanceof|return|transient|catch|extends|int|short|try|char|final|interface|static|void|class|finally|long|strictfp|volatile|const|float|native|super|while)\b/,number:/\b0b[01]+\b|\b0x[\da-f]*\.?[\da-fp\-]+\b|\b\d*\.?\d+[e]?[\d]*[df]\b|\b\d*\.?\d+\b/i,operator:{pattern:/(^|[^\.])(?:\+=|\+\+?|-=|--?|!=?|<{1,2}=?|>{1,3}=?|==?|&=|&&?|\|=|\|\|?|\?|\*=?|\/=?|%=?|\^=?|:|~)/m,lookbehind:!0}});
</script>
<script type="text/javascript">
    Prism.hooks.add("after-highlight",function(e){var t=e.element.parentNode,s=/\s*\bline-numbers\b\s*/;if(t&&/pre/i.test(t.nodeName)&&(s.test(t.className)||s.test(e.element.className))){s.test(e.element.className)&&(e.element.className=e.element.className.replace(s,"")),s.test(t.className)||(t.className+=" line-numbers");var a,n=1+e.code.split("\n").length,l=new Array(n);l=l.join("<span></span>"),a=document.createElement("span"),a.className="line-numbers-rows",a.innerHTML=l,t.hasAttribute("data-start")&&(t.style.counterReset="linenumber "+(parseInt(t.getAttribute("data-start"),10)-1)),e.element.appendChild(a)}});
</script>
<script type="text/x-mathjax-config">
if (typeof MathJaxListener !== 'undefined') {
  MathJax.Hub.Register.StartupHook('End', function () {
    MathJaxListener.invokeCallbackForKey_('End');
  });
}
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>

</html>
